{"remainingRequest":"E:\\研一下\\Vue学习\\前端\\vue_node_admin-master\\item\\node_modules\\babel-loader\\lib\\index.js!E:\\研一下\\Vue学习\\前端\\vue_node_admin-master\\item\\src\\permission.js","dependencies":[{"path":"E:\\研一下\\Vue学习\\前端\\vue_node_admin-master\\item\\src\\permission.js","mtime":1683458471900},{"path":"E:\\研一下\\Vue学习\\前端\\vue_node_admin-master\\item\\babel.config.js","mtime":1682257123000},{"path":"E:\\研一下\\Vue学习\\前端\\vue_node_admin-master\\item\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1683432540690},{"path":"E:\\研一下\\Vue学习\\前端\\vue_node_admin-master\\item\\node_modules\\babel-loader\\lib\\index.js","mtime":1683432547123}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9vYmplY3RTcHJlYWQgZnJvbSAiRTovXHU3ODE0XHU0RTAwXHU0RTBCL1Z1ZVx1NUI2Nlx1NEU2MC9cdTUyNERcdTdBRUYvdnVlX25vZGVfYWRtaW4tbWFzdGVyL2l0ZW0vbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL29iamVjdFNwcmVhZDIuanMiOwppbXBvcnQgX2FzeW5jVG9HZW5lcmF0b3IgZnJvbSAiRTovXHU3ODE0XHU0RTAwXHU0RTBCL1Z1ZVx1NUI2Nlx1NEU2MC9cdTUyNERcdTdBRUYvdnVlX25vZGVfYWRtaW4tbWFzdGVyL2l0ZW0vbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IuanMiOwppbXBvcnQgInJlZ2VuZXJhdG9yLXJ1bnRpbWUvcnVudGltZS5qcyI7CmltcG9ydCByb3V0ZXIgZnJvbSAiLi9yb3V0ZXIiOwppbXBvcnQgc3RvcmUgZnJvbSAiLi9zdG9yZSI7CmltcG9ydCB7IE1lc3NhZ2UgfSBmcm9tICJlbGVtZW50LXVpIjsKaW1wb3J0IE5Qcm9ncmVzcyBmcm9tICJucHJvZ3Jlc3MiOyAvLyBwcm9ncmVzcyBiYXIKCmltcG9ydCAibnByb2dyZXNzL25wcm9ncmVzcy5jc3MiOyAvLyBwcm9ncmVzcyBiYXIgc3R5bGUKCmltcG9ydCB7IGdldFRva2VuIH0gZnJvbSAiQC91dGlscy9hdXRoIjsgLy8gZ2V0IHRva2VuIGZyb20gY29va2llCgppbXBvcnQgZ2V0UGFnZVRpdGxlIGZyb20gIkAvdXRpbHMvZ2V0LXBhZ2UtdGl0bGUiOwpOUHJvZ3Jlc3MuY29uZmlndXJlKHsKICBzaG93U3Bpbm5lcjogZmFsc2UKfSk7IC8vIE5Qcm9ncmVzcyBDb25maWd1cmF0aW9uCgp2YXIgd2hpdGVMaXN0ID0gWyIvbG9naW4iLCAiL2F1dGgtcmVkaXJlY3QiXTsgLy8gbm8gcmVkaXJlY3Qgd2hpdGVsaXN0Cgpyb3V0ZXIuYmVmb3JlRWFjaCggLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICB2YXIgX3JlZiA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZSh0bywgZnJvbSwgbmV4dCkgewogICAgdmFyIGhhc1Rva2VuLCBoYXNSb2xlcywgYWNjZXNzUm91dGVzOwogICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICBpZiAoISh0by5wYXRoLmluZGV4T2YoIi8qIikgIT09IC0xKSkgewogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgIC8vIHN0YXJ0IHByb2dyZXNzIGJhcgogICAgICAgICAgICBOUHJvZ3Jlc3Muc3RhcnQoKTsgLy8gc2V0IHBhZ2UgdGl0bGUKCiAgICAgICAgICAgIGRvY3VtZW50LnRpdGxlID0gZ2V0UGFnZVRpdGxlKHRvLm1ldGEudGl0bGUpOyAvLyBkZXRlcm1pbmUgd2hldGhlciB0aGUgdXNlciBoYXMgbG9nZ2VkIGluCgogICAgICAgICAgICBoYXNUb2tlbiA9IGdldFRva2VuKCk7CgogICAgICAgICAgICBpZiAoIWhhc1Rva2VuKSB7CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDMyOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoISh0by5wYXRoID09PSAiL2xvZ2luIikpIHsKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTE7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIGlmIGlzIGxvZ2dlZCBpbiwgcmVkaXJlY3QgdG8gdGhlIGhvbWUgcGFnZQogICAgICAgICAgICBuZXh0KHsKICAgICAgICAgICAgICBwYXRoOiAiLyIKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIE5Qcm9ncmVzcy5kb25lKCk7IC8vIGhhY2s6IGh0dHBzOi8vZ2l0aHViLmNvbS9QYW5KaWFDaGVuL3Z1ZS1lbGVtZW50LWFkbWluL3B1bGwvMjkzOQoKICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDMwOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIDExOgogICAgICAgICAgICAvLyBkZXRlcm1pbmUgd2hldGhlciB0aGUgdXNlciBoYXMgb2J0YWluZWQgaGlzIHBlcm1pc3Npb24gcm9sZXMgdGhyb3VnaCBnZXRJbmZvCiAgICAgICAgICAgIGhhc1JvbGVzID0gc3RvcmUuZ2V0dGVycy5yb2xlcyAmJiBzdG9yZS5nZXR0ZXJzLnJvbGVzLmxlbmd0aCA+IDA7CgogICAgICAgICAgICBpZiAoIWhhc1JvbGVzKSB7CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDE2OwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgICBuZXh0KCk7CiAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAzMDsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAxNjoKICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDE2OwogICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTk7CiAgICAgICAgICAgIHJldHVybiBzdG9yZS5kaXNwYXRjaCgidXNlci9nZXRJbmZvIik7CgogICAgICAgICAgY2FzZSAxOToKICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDIxOwogICAgICAgICAgICByZXR1cm4gc3RvcmUuZGlzcGF0Y2goInBlcm1pc3Npb24vZ2VuZXJhdGVSb3V0ZXMiKTsKCiAgICAgICAgICBjYXNlIDIxOgogICAgICAgICAgICBhY2Nlc3NSb3V0ZXMgPSBfY29udGV4dC5zZW50OwogICAgICAgICAgICBhY2Nlc3NSb3V0ZXMucHVzaCh7CiAgICAgICAgICAgICAgcGF0aDogJyonLAogICAgICAgICAgICAgIHJlZGlyZWN0OiAiLzQwNCIsCiAgICAgICAgICAgICAgaGlkZGVuOiB0cnVlCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICByb3V0ZXIuYWRkUm91dGVzKGFjY2Vzc1JvdXRlcyk7CiAgICAgICAgICAgIG5leHQoX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCB0byksIHt9LCB7CiAgICAgICAgICAgICAgcmVwbGFjZTogdHJ1ZQogICAgICAgICAgICB9KSk7CiAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAzMDsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAyNzoKICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDI3OwogICAgICAgICAgICBfY29udGV4dC50MCA9IF9jb250ZXh0WyJjYXRjaCJdKDE2KTsKICAgICAgICAgICAgTlByb2dyZXNzLmRvbmUoKTsKCiAgICAgICAgICBjYXNlIDMwOgogICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMzM7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgMzI6CiAgICAgICAgICAgIC8qIGhhcyBubyB0b2tlbiovCiAgICAgICAgICAgIGlmICh3aGl0ZUxpc3QuaW5kZXhPZih0by5wYXRoKSAhPT0gLTEpIHsKICAgICAgICAgICAgICAvLyBpbiB0aGUgZnJlZSBsb2dpbiB3aGl0ZWxpc3QsIGdvIGRpcmVjdGx5CiAgICAgICAgICAgICAgbmV4dCgpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIC8vIG90aGVyIHBhZ2VzIHRoYXQgZG8gbm90IGhhdmUgcGVybWlzc2lvbiB0byBhY2Nlc3MgYXJlIHJlZGlyZWN0ZWQgdG8gdGhlIGxvZ2luIHBhZ2UuCiAgICAgICAgICAgICAgbmV4dCgiL2xvZ2luP3JlZGlyZWN0PSIuY29uY2F0KHRvLnBhdGgpKTsKICAgICAgICAgICAgICBOUHJvZ3Jlc3MuZG9uZSgpOwogICAgICAgICAgICB9CgogICAgICAgICAgY2FzZSAzMzoKICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9LCBfY2FsbGVlLCBudWxsLCBbWzE2LCAyN11dKTsKICB9KSk7CgogIHJldHVybiBmdW5jdGlvbiAoX3gsIF94MiwgX3gzKSB7CiAgICByZXR1cm4gX3JlZi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogIH07Cn0oKSk7CnJvdXRlci5hZnRlckVhY2goZnVuY3Rpb24gKCkgewogIC8vIGZpbmlzaCBwcm9ncmVzcyBiYXIKICBOUHJvZ3Jlc3MuZG9uZSgpOwp9KTs="},{"version":3,"sources":["E:/研一下/Vue学习/前端/vue_node_admin-master/item/src/permission.js"],"names":["router","store","Message","NProgress","getToken","getPageTitle","configure","showSpinner","whiteList","beforeEach","to","from","next","path","indexOf","start","document","title","meta","hasToken","done","hasRoles","getters","roles","length","dispatch","accessRoutes","push","redirect","hidden","addRoutes","replace","afterEach"],"mappings":";;;AAAA,OAAOA,MAAP,MAAmB,UAAnB;AACA,OAAOC,KAAP,MAAkB,SAAlB;AACA,SAASC,OAAT,QAAwB,YAAxB;AACA,OAAOC,SAAP,MAAsB,WAAtB,C,CAAmC;;AACnC,OAAO,yBAAP,C,CAAkC;;AAClC,SAASC,QAAT,QAAyB,cAAzB,C,CAAyC;;AACzC,OAAOC,YAAP,MAAyB,wBAAzB;AAEAF,SAAS,CAACG,SAAV,CAAoB;AAAEC,EAAAA,WAAW,EAAE;AAAf,CAApB,E,CAA6C;;AAE7C,IAAMC,SAAS,GAAG,CAAC,QAAD,EAAW,gBAAX,CAAlB,C,CAAgD;;AAEhDR,MAAM,CAACS,UAAP;AAAA,qEAAkB,iBAAOC,EAAP,EAAWC,IAAX,EAAiBC,IAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAEbF,EAAE,CAACG,IAAH,CAAQC,OAAR,CAAgB,IAAhB,MAAwB,CAAC,CAFZ;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAGhB;AACAX,YAAAA,SAAS,CAACY,KAAV,GAJgB,CAMhB;;AACAC,YAAAA,QAAQ,CAACC,KAAT,GAAiBZ,YAAY,CAACK,EAAE,CAACQ,IAAH,CAAQD,KAAT,CAA7B,CAPgB,CAShB;;AACME,YAAAA,QAVU,GAUCf,QAAQ,EAVT;;AAAA,iBAYZe,QAZY;AAAA;AAAA;AAAA;;AAAA,kBAaVT,EAAE,CAACG,IAAH,KAAY,QAbF;AAAA;AAAA;AAAA;;AAcZ;AACAD,YAAAA,IAAI,CAAC;AAAEC,cAAAA,IAAI,EAAE;AAAR,aAAD,CAAJ;AACAV,YAAAA,SAAS,CAACiB,IAAV,GAhBY,CAgBM;;AAhBN;AAAA;;AAAA;AAkBZ;AACMC,YAAAA,QAnBM,GAmBKpB,KAAK,CAACqB,OAAN,CAAcC,KAAd,IAAuBtB,KAAK,CAACqB,OAAN,CAAcC,KAAd,CAAoBC,MAApB,GAA6B,CAnBzD;;AAAA,iBAoBRH,QApBQ;AAAA;AAAA;AAAA;;AAqBVT,YAAAA,IAAI;AArBM;AAAA;;AAAA;AAAA;AAAA;AAAA,mBA2BFX,KAAK,CAACwB,QAAN,CAAe,cAAf,CA3BE;;AAAA;AAAA;AAAA,mBA8BmBxB,KAAK,CAACwB,QAAN,CAAe,2BAAf,CA9BnB;;AAAA;AA8BFC,YAAAA,YA9BE;AA+BRA,YAAAA,YAAY,CAACC,IAAb,CAAkB;AAChBd,cAAAA,IAAI,EAAE,GADU;AAEhBe,cAAAA,QAAQ,EAAE,MAFM;AAGhBC,cAAAA,MAAM,EAAE;AAHQ,aAAlB;AAKA7B,YAAAA,MAAM,CAAC8B,SAAP,CAAiBJ,YAAjB;AAGAd,YAAAA,IAAI,iCAAMF,EAAN;AAAUqB,cAAAA,OAAO,EAAE;AAAnB,eAAJ;AAvCQ;AAAA;;AAAA;AAAA;AAAA;AAyCR5B,YAAAA,SAAS,CAACiB,IAAV;;AAzCQ;AAAA;AAAA;;AAAA;AA8Cd;AAEA,gBAAIZ,SAAS,CAACM,OAAV,CAAkBJ,EAAE,CAACG,IAArB,MAA+B,CAAC,CAApC,EAAuC;AACrC;AACAD,cAAAA,IAAI;AACL,aAHD,MAGO;AACL;AACAA,cAAAA,IAAI,2BAAoBF,EAAE,CAACG,IAAvB,EAAJ;AACAV,cAAAA,SAAS,CAACiB,IAAV;AACD;;AAvDa;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAlB;;AAAA;AAAA;AAAA;AAAA;AA2DApB,MAAM,CAACgC,SAAP,CAAiB,YAAM;AACrB;AACA7B,EAAAA,SAAS,CAACiB,IAAV;AACD,CAHD","sourcesContent":["import router from \"./router\";\nimport store from \"./store\";\nimport { Message } from \"element-ui\";\nimport NProgress from \"nprogress\"; // progress bar\nimport \"nprogress/nprogress.css\"; // progress bar style\nimport { getToken } from \"@/utils/auth\"; // get token from cookie\nimport getPageTitle from \"@/utils/get-page-title\";\n\nNProgress.configure({ showSpinner: false }); // NProgress Configuration\n\nconst whiteList = [\"/login\", \"/auth-redirect\"]; // no redirect whitelist\n\nrouter.beforeEach(async (to, from, next) => {\n  //如果点击的是父级路由\n  if(to.path.indexOf(\"/*\")!==-1) return;\n  // start progress bar\n  NProgress.start();\n\n  // set page title\n  document.title = getPageTitle(to.meta.title);\n\n  // determine whether the user has logged in\n  const hasToken = getToken();\n\n  if (hasToken) {\n    if (to.path === \"/login\") {\n      // if is logged in, redirect to the home page\n      next({ path: \"/\" });\n      NProgress.done(); // hack: https://github.com/PanJiaChen/vue-element-admin/pull/2939\n    } else {\n      // determine whether the user has obtained his permission roles through getInfo\n      const hasRoles = store.getters.roles && store.getters.roles.length > 0;\n      if (hasRoles) {\n        next();\n      } else {\n        try {\n          // get user info\n          // note: roles must be a object array! such as: ['admin'] or ,['developer','editor']\n          //角色必须要是一个对象数组，如 ['admin']或者['student','teacher']\n          await store.dispatch(\"user/getInfo\");\n          // generate accessible routes map based on roles\n          //根据角色生成可访问的路由菜单\n          const accessRoutes = await store.dispatch(\"permission/generateRoutes\");\n          accessRoutes.push({\n            path: '*',\n            redirect: \"/404\",\n            hidden: true\n          })\n          router.addRoutes(accessRoutes);\n\n\n          next({ ...to, replace: true });\n        } catch (error) {\n          NProgress.done();\n        }\n      }\n    }\n  } else {\n    /* has no token*/\n\n    if (whiteList.indexOf(to.path) !== -1) {\n      // in the free login whitelist, go directly\n      next();\n    } else {\n      // other pages that do not have permission to access are redirected to the login page.\n      next(`/login?redirect=${to.path}`);\n      NProgress.done();\n    }\n  }\n});\n\nrouter.afterEach(() => {\n  // finish progress bar\n  NProgress.done();\n});\n"]}]}